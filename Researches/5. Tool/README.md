# 파일 시스템 확장성 분석 벤치마크 개발 (FxMark)

매니코어 환경에서 파일 시스템의 확장성을 평가하고 발견하기 어려운 병목 현상을 관찰하는 것을 목적으로 하는 벤치마크이다. 소스코드는 https://github.com/oslab-swrc/fxmark에 있다.

# 멀티큐 기반 고속 저장장치 에뮬레이터(Ramdisk_MQ)

다중 코어 환경에서의 리눅스 블록 계층의 확장성 평가를 위한 다중 큐 기반의 RAM 블록 장치이다. 관련 소프트웨어는 https://github.com/oslab-swrc/ramdisk_mq에 공개되어 있다.

# 블록 계층 분석기(blk_mq_analyzer)

각 소프트웨어 큐 별로 I/O 처리량을 수집하고 소프트웨어 큐와 하드웨어 큐 간 매핑 관계를 이용하여 각 하드웨어 큐가 처리한 I/O 양을 수집한다. 수집한 결과를 활용하여 각 하드웨어 큐 별로 처리한 I/O의 개수를 알 수 있으며 이를 통해 불균형 현상이 실제로 존재하는지 검증한다. 블록 계층 분석기는 https://github.com/oslab-swrc/blk-mq-analyzer에 공개되었다.

# 영구메모리 응용의 쓰기 증폭 측정 도구(pmperf)

영구메모리 응용을 위한 쓰기 증폭 측정 도구이다. pmperf는 인텔에서 구현, 배포하고 있는 PCM 라이브러리와 ipmctl 라이브러리를 활용하여 구현하였다. 도구는 https://github.com/oslab-swrc/pmperf에 공개하였다.

# CPU idle 상태 추적 도구(Dark insight)

리눅스 Perf나 인텔의 VTune 같은 기존의 프로파일링 도구들은 주기적으로 각 CPU의 명령어를 샘플링하여 CPU 사이클 관점에서 분석한다. 이 방법은 CPU를 많이 사용하는 코드를 찾아내는데 효율적이지만 실행시간의 0.1% 동안 실행되는 작은 순차적 부분은 식별하기 어렵다. 이런 순차적 부분은 잠금(Lock)이나 배리어(Barrier)와 같은 동기화 요소에 의해 조정되는데, 뮤텍스(Mutex)나 세마포어(Semaphore)와 같은 블록킹 동기화 요소를 사용할 때, 태스크는 블록(Block)이 되므로 더욱 알기 힘들어진다. 이렇게 샘플링 기반의 프로파일 도구들은 경합이 발생한 곳에서 유용한 정보를 가져오지 못한다. CPU idle 상태 추적 도구인 Dark Insight는 확장성의 병목점을 찾기 위해서 시스템의 유휴상태(idle) 상태를 프로파일링 한다. 도구의 소스코드는 https://github.com/oslab-swrc에 공개한다.

# 파일 시스템 정확성 교차 검증 도구 개발(Juxta)

최신의 파일 시스템들은 매우 복잡하게 구현되어 있으며, 버그를 찾고 이를 해결하는 것은 어려우면서도 중요한 과제이다. 정적 분석 도구를 활용하면 다양한 버그를 찾을 수는 있지만, 개발자의 의도에 대한 깊은 이해가 있어야 찾을 수 있는 시맨틱 버그(semantic bug)는 기존의 도구들로는 찾을 수 없었다. 이에, 본 과제에서는 파일 시스템의 시맨틱 버그를 자동으로 찾아주는 Juxta를 개발하였지만, 개발을 시작한 배경은 리눅스 파일 시스템의 스케일러빌러티 문제를 분석하기 위해서 파일 시스템들간의 동작 흐름(flow)를 비교, 분석하기 위함 목적이였다.  리눅스에 포함된 모든 파일 시스템은 호환성 제공을 위해 VFS 계층에 정의된 규칙에 따라 동작한다. Juxta는 각각의 파일 시스템의 동작을 교차 검증하여 이 규칙을 따르도록 구현되어 있는지 파악한다. 따라서 리눅스 커널 내에 VFS를 따르도록 구현된 모든 파일 시스템은 교차 검증을 통한 버그 찾기의 대상이 될 수 있다. 소스코드는 https://github.com/oslab-swrc/juxta에 있다.

# 리눅스 파일 시스템의 시맨틱 버그 탐지 도구(HYDRA)

리눅스 파일시스템의 시맨틱 버그를 탐지하기 위한 도구인 HYDRA는 파일시스템의 다양한 시맨틱 버그를 찾기 위한 퍼징(Fuzzing) 기반의 포괄적인 프레임워크이다. 퍼징 기법이란 소프트웨어의 문제점을 찾기 위한 테스팅 기법으로 다양한 입력값을 소프트웨어에 인위적으로 주입하여 소프트웨어에 문제가 있는지 없는지를 검색하는 기법이다. HYDRA는 이러한 퍼징 기법을 이용하여 파일시스템을 대상으로 광범위하고 자동화된 입력값을 조합하여 테스트를 진행하고 파일 시스템의 버그를 탐색한다. 또한 파일시스템의 일관성 불일치(crash inconsistency), 명세 위반(specification violation), 논리적 버그(logic bug), 메모리 오류(memory error)등 다양한 시멘틱 버그를 찾을 수 있도록, 기존 버그 검사기와 연동 가능하다. https://github.com/oslab-swrc/hydra에 오픈소스로 공개되어 있다.

# 데이터 레이스 탐지 도구(Krace)

기존의 파일시스템 버그를 찾는 방법으로는 강도 높은 워크로드로 파일시스템에서 데이터 레이스가 일어날 확률을 높이거나, 커버리지에 기반을 둔 퍼징 (fuzzing) 기법을 통해 광범위하고 자동화된 입력값을 조합하여 버그를 탐색하였다. 그러나 기존의 퍼징 기법은 프로그램 실행의 순차적 측면만을 추적여 단일 스레드 시스템콜은 효과적으로 탐색할 수 있지만 멀티 스레드 상황에서 발생하는 동시성 버그를 찾아내기에는 한계를 가지고 있다. https://github.com/oslab-swrc/krace에 도구의 소스코드가 있다.

# 더블페치 버그 탐지 도구 개발(Deadline)

시스템 호출 실행 중에는 일반적으로 커널이 사용자 공간 메모리를 여러 번 읽는 경우가 발생한다. 이때 가져온 사용자 공간 메모리가 읽기에서 변경될 수 있는 경우, 즉 변수의 값을 확인하는 단계와 실제 사용하는 단계에서 값이 변경되는 이중 가져오기(더블페치) 버그로 알려져 있는 레이스 컨디션이 발생할 경우 소프트웨어에 심각한 버그가 있을 수 있다.
Deadline은 더블페치 버그의 정확한 정의를 제시하고 정의에 기반을 둔 정적 분석 시스템으로 소프트웨어의 더블페치 버그를 자동으로 감지한다. https://github.com/sslab-gatech/deadline에 공개되어 있다. 

# 프로그램 인터페이스 오류 탐지 도구(APISan)

소스코드 안에서 같은 API(Application Programming Interface)가 어떻게 사용되었는지 비교하여 잘못 사용된 것으로 판단되는 API의 사용 위치를 알려주는 도구이다. 복잡성이 증가하고 있는 최근의 소프트웨어에서 API를 잘못 사용하면 원하지 않는 잘못된 결과를 얻을 수 있고, 심각한 보안 문제를 일으키기도 하므로 사전 탐지가 중요하다. 그러나 소프트웨어의 규모가 커짐에 따라 사람이 개입하여 찾아내기 어려워지고 있다. 본 도구는 사람의 개입 없이 자동으로 소스 코드의 API 사용 내역을 추적하고 분석한 추론을 통하여 올바른 API 사용 방법을 규정하고, 잘못된 사용을 찾는다. 기존 기법은 사람이 API를 어떻게 사용해야 하는지 정의하고, 검색 프로그램에 적용되도록 설정하여야 한다. 그리고 잘못된 사용 또는 옳은 사용 기준 등을 입력한 후 소스코드 분석을 수행해야 하는 문제가 있다. 본 도구는 함수의 반환 값 추론, 함수의 인수 간의 관계 추론, 일상적이지 않은 함수 간의 관계 추론, 간접적으로 함수의 전·후 상태 추론 등을 데이터 베이스를 사용하여 사람의 개입이 필요하지 않은 자동화 도구이다. 관련 소프트웨어는 https://github.com/sslab-gatech/apisan 에 공개되어 있다.

# 초기화되지 않은 변수로 인한 버그 탐지 도구(UniSan)

초기화되지 않은 변수를 사용할 때 발생할 수 있는 데이터 유출을 방지하기 위하여, 초기화하지 않고 사용하는 변수가 있을 때 발생할 수 있는 버그를 탐지하기 위해 설계되고 구현된 도구이다. 관련 소프트웨어는 https://github.com/oslab-swrc/unisan에 공개되어 있다.

# 인텔 메모리 보호키 지원 라이브러리 개발 (libmpk)

libmpk는 MPK를 소프트웨어 라이브러리로 추상화한 기술이다. MPK의 기능에 1) protection-key-use-after-free 문제를 해결하기 위한 하드웨어 제어키 가상화, 2) mprotect() 시맨틱과 호환을 지원하기 위한 쓰레드 간의 키 동기화 지연, 3) 메타데이터 매핑 정보의 무결성 기술을 추가하여 보완하였다. 이를 통해 하드웨어 제약을 극복할 뿐만 아니라, 성능, 안전성, 확장성을 보장한다. 소스코드는 Github (https://github.com/oslab-swrc/ libmpk)에 공개하였다. 



